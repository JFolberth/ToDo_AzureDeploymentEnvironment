# NOTE: As of 1/20/2025, a bug prevents the use of inbuilt tasks with the ~ syntax for building your image into an image definition. 
# A bugfix is rolling out, and this issue will be resolved by 1/27/2024. 
# In the mean time, you can still use these image definitions with inbuilt tasks on a pool directly without building an image.

$schema: "1.0"
name: "frontend-bicep"
tasks:

- name: ~/winget
  parameters:
    downloadUrl: 'https://raw.githubusercontent.com/JFolberth/ToDo_AzureDeploymentEnvironment/refs/heads/main/devbox/config.yaml'

- name: ~/powershell
  parameters:
    command: |
      $env:Path = [System.Environment]::GetEnvironmentVariable('Path','Machine') + ';' + [System.Environment]::GetEnvironmentVariable('Path','User') 
      echo  $env:Path
      code --extensions-dir "Program Files\Microsoft VS Code\resources\app\extensions" --install-extension github.copilot
      code --extensions-dir "Program Files\Microsoft VS Code\resources\app\extensions" --install-extension github.copilot-chat        
      code --extensions-dir "Program Files\Microsoft VS Code\resources\app\extensions" --install-extension GitHub.vscode-github-actions
      code --extensions-dir "Program Files\Microsoft VS Code\resources\app\extensions" --install-extension ms-vscode-remote.remote-wsl
      code --extensions-dir "Program Files\Microsoft VS Code\resources\app\extensions" --install-extension ms-vscode-remote.remote-containers
      code --extensions-dir "Program Files\Microsoft VS Code\resources\app\extensions" --install-extension ms-azuretools.azure-dev
      code --extensions-dir "Program Files\Microsoft VS Code\resources\app\extensions" --install-extension ms-azuretools.vscode-docker
      code --extensions-dir "Program Files\Microsoft VS Code\resources\app\extensions" --install-extension ms-dotnettools.csdevkit
      code --extensions-dir "Program Files\Microsoft VS Code\resources\app\extensions" --install-extension ms-azuretools.vscode-bicep

- name: git-clone
  description: Clone this repository into C:\Workspaces
  parameters:
    repositoryUrl: https://github.com/JFolberth/ToDo_AzureDeploymentEnvironment
    directory: Z:\repos\ToDo_AzureDeploymentEnvironment